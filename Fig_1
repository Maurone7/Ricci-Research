import matplotlib.pyplot as plt
import numpy as np
from astropy import constants

sun_luminosity = constants.L_sun.value

# FROM https://arxiv.org/pdf/1605.05772.pdf TABLE 1

source_list_barenfeld = ['J15354856-2958551', 'J15514032-2146103', 'J15521088-2125372', 'J15530132-2114135',
                         'J15534211-2049282', 'J15551704-2322165', 'J15554883-2512240', 'J15562477-2225552',
                         'J15570641-2206060', 'J15572986-2258438', 'J15581270-2328364', 'J15582981-2310077',
                         'J15583692-2257153', 'J15584772-1757595', 'J16001330-2418106', 'J16001730-2236504',
                         'J16001844-2230114', 'J16014086-2258103', 'J16014157-2111380', 'J16020039-2221237',
                         'J16020287-2236139', 'J16020757-2257467', 'J16024152-2138245', 'J16025123-2401574',
                         'J16030161-2207523', 'J16031329-2112569', 'J16032225-2413111', 'J16035767-2031055',
                         'J16035793-1942108', 'J16041740-1942287', 'J16042165-2130284', 'J16043916-1942459',
                         'J16050231-1941554', 'J16052459-1954419', 'J16052556-2035397', 'J16052661-1957050',
                         'J16053215-1933159', 'J16054540-2023088', 'J16055863-1949029', 'J16060061-1957114',
                         'J16061330-2212537', 'J16062196-1928445', 'J16062277-2011243', 'J16063539-2516510',
                         'J16064102-2455489', 'J16064115-2517044', 'J16064385-1908056', 'J16070014-2033092',
                         'J16070211-2019387', 'J16070873-1927341', 'J16071971-2020555', 'J16072625-2432079',
                         'J16072747-2059442', 'J16073939-1917472', 'J16075796-2040087', 'J16080555-2218070',
                         'J16081566-2222199', 'J16082324-1930009', 'J16082751-1949047', 'J16083455-2211559',
                         'J16084894-2400045', 'J16090002-1908368', 'J16090075-1908526', 'J16093558-1828232',
                         'J16094098-2217594', 'J16095361-1754474', 'J16095441-1906551', 'J16095933-1800090',
                         'J16101473-1919095', 'J16101888-2502325', 'J16102174-1904067', 'J16102819-1910444',
                         'J16102857-1904469', 'J16103956-1916524', 'J16104202-2101319', 'J16104636-1840598',
                         'J16111330-2019029', 'J16111534-1757214', 'J16112057-1820549', 'J16113134-1838259',
                         'J16115091-2012098', 'J16122737-2009596', 'J16123916-1859284', 'J16124893-1800525',
                         'J16125533-2319456', 'J16130996-1904269', 'J16133650-2503473', 'J16135434-2320342',
                         'J16141107-2305362', 'J16142029-1906481', 'J16142893-1857224', 'J16143367-1900133',
                         'J16145918-2750230', 'J16145928-2459308', 'J16151239-2420091', 'J16153456-2242421',
                         'J16154416-1921171', 'J16163345-2521505', 'J16181618-2619080', 'J16181904-2028479',
                         'J16215466-2043091', 'J16220961-1953005', 'J16230783-2300596', 'J16235385-2946401',
                         'J16270942-2148457', 'J16303390-2428062']

    # the fluxes have not been mathematically manipulated
flux_list_0_88mm_barenfeld = [1.92, 0.76, -0.10, 5.78, 2.93, 0.11, -0.14, 0.28, 0.32, -0.04, 0.00, 5.86, 174.92, -0.20, 0.05,
                              0.10, 3.89, 3.45, 0.66, -0.08, 0.04, 5.26, 10.25, 0.07, 2.81, 0.06, 2.42, 4.30, 1.17, 0.89,
                              218.76, 0.49, -0.16, 0.22, 1.53, 0.07, 0.25, 7.64, -0.08, 0.00, -0.20, 4.08, 0.59, 1.69, 3.05,
                              0.20, 0.84, 0.22, -0.09, -0.09, 0.16, 13.12, 2.13, 0.58, 23.49, 0.02, 0.97, 43.19, 0.76, 0.01,
                              -0.06, 1.73, 47.28, 0.69, 0.44, 0.87, 0.50, 0.67, 0.01, 0.30, -0.05, 0.05, 0.66, 0.07, 0.17, 1.78,
                              4.88, 0.18, -0.06, 903.56, 0.66, 0.53, 6.01, 0.11, 0.08, -0.05, 0.88, 7.53, 4.77, 40.69, 0.10,
                              1.24, 0.03, -0.03, 0.22, 11.75, 23.57, 2.88, -0.07, 4.62, 0.49, 0.07, -0.35, 0.11, 2.87, 0.60]

    # the masses are log(M/M_sun)
masses_list_barenfeld = [-0.58, -0.70, -0.75, -0.68, -0.57, -0.46, 0.07, -0.68, -0.72, -0.70, 0.1, -0.59, 0.14, 0.08, -0.24,
                         -0.61, -0.73, -0.63, -0.73, -0.33, -0.30, -0.47, -0.81, 0.04, -0.82, -0.8, -0.58, 0.02, -0.44, -0.6,
                         0.00, -0.59, -0.79, -0.6, -0.83, -0.73, -0.85, -0.44, -0.68, -0.80, -0.59, -0.25, -0.83, -0.80, -0.8,
                         -0.6, -0.05, -0.51, -0.84, -0.7, -0.55, -0.58, -0.73, -0.43, -0.35, -0.54, -0.55, -0.18, -0.79, -0.78,
                         -0.66, -0.82, -0.19, -0.55, -0.25, -0.59, -0.34, -0.64, -0.43, -0.77, -0.34, -0.74, -0.49, -0.44, 0.02,
                         -0.79, -0.52, -0.33, 0.03, 0.05, -0.6, -0.78, -0.29, -0.54, 0.21, -0.67, -0.59, -0.72, 0.23, -0.25,
                         -0.46, -0.5, 0.03, -0.66, -0.74, -0.25, -0.01, -0.29, -0.75, -0.79, -0.10, -0.56, 0.12, 0.16, -0.79,
                         -0.66]

    # error are log(err)
lower_error_mass_barenfeld = [0.09, 0.12, 0.13, 0.12, 0.09, 0.08, 0.05, 0.12, 0.13, 0.12 ,0.06, 0.11, 0.05, 0.01, 0.05,
                              0.10, 0.12, 0.11, 0.13, 0.09, 0.05, 0.09, 0.15, 0.04, 0.15, 0.15, 0.10, 0.05, 0.10, 0.10,
                              0.06, 0.11, 0.15, 0.11, 0.15, 0.12, 0.14, 0.10, 0.12, 0.14, 0.09, 0.05, 0.15, 0.15, 0.15,
                              0.11, 0.04, 0.09, 0.15, 0.12, 0.10, 0.10, 0.12, 0.09, 0.10, 0.09, 0.09, 0.04, 0.14, 0.14,
                              0.12, 0.15, 0.05, 0.09, 0.04, 0.11, 0.10, 0.11, 0.09, 0.13, 0.10, 0.13, 0.08, 0.10, 0.05,
                              0.15, 0.08, 0.10, 0.05, 0.09, 0.11, 0.14, 0.07, 0.09, 0.07, 0.12, 0.10, 0.12, 0.05, 0.05,
                              0.08, 0.08, 0.04, 0.11, 0.13, 0.04, 0.04, 0.08, 0.13, 0.14, 0.04, 0.08, 0.04, 0.11, 0.15,
                              0.12]

upper_error_mass_barenfeld = [0.09, 0.13, 0.13, 0.13, 0.10, 0.08, 0.04, 0.13, 0.14, 0.13, 0.05, 0.12, 0.05, 0.05, 0.05,
                              0.11, 0.14, 0.11, 0.14, 0.08, 0.05, 0.08, 0.10, 0.05, 0.09, 0.11, 0.11, 0.05, 0.08, 0.12,
                              0.05, 0.12, 0.12, 0.11, 0.09, 0.14, 0.08, 0.08, 0.13, 0.11, 0.10, 0.04, 0.09, 0.12, 0.11,
                              0.12, 0.05, 0.10, 0.08, 0.13, 0.11, 0.11, 0.13, 0.08, 0.10, 0.10, 0.10, 0.05, 0.11, 0.12,
                              0.12, 0.09, 0.05, 0.11, 0.04, 0.12, 0.09, 0.12, 0.08, 0.13, 0.09, 0.14, 0.07, 0.08, 0.06,
                              0.12, 0.09, 0.08, 0.06, 0.10, 0.11, 0.13, 0.07, 0.10, 0.09, 0.12, 0.11, 0.13, 0.05, 0.04,
                              0.08, 0.07, 0.02, 0.12, 0.13, 0.04, 0.05, 0.08, 0.13, 0.12, 0.04, 0.08, 0.05, 0.10, 0.12,
                              0.12]

    # the masses are M/M_earth
masses_list_disk = [0.62, 0.49, 0.52, 3.34, 1.18, 0.17, 0.07, 0.46, 0.69, 0.40, 0.07, 3.77, 24.30, 0.09, 0.16, 0.22, 2.08,
                 1.48, 0.56, 0.11, 0.35, 2.08, 7.63, 0.12, 2.48, 0.29, 1.10, 0.98, 0.53, 0.45, 52.29, 0.27, 0.39,
                 0.34, 1.05, 0.28, 0.75, 3.27, 0.26, 0.23, 0.12, 0.99, 0.43, 1.51, 3.06, 0.38, 0.23, 0.30, 0.49, 0.28,
                 0.32, 5.71, 0.99, 0.22, 9.31, 0.15, 0.39, 13.94, 0.42, 0.28, 0.27, 1.15, 13.50, 0.34, 0.10, 0.58, 0.17,
                 0.32, 0.20, 0.49, 0.17, 0.48, 0.17, 0.24, 0.12, 1.53, 1.83, 0.19, 0.10, 127.28, 0.32, 0.39, 1.79, 0.27,
                 0.05, 0.25, 0.41, 3.81, 0.68, 10.52, 0.19, 0.36, 0.11, 0.16, 0.53, 2.57, 5.99, 1.15, 0.22, 3.02,
                 0.13, 0.16, 0.07, 0.06, 2.41, 0.32]

power_luminosity_list = [-1.39, -1.13, 0.47, -1.18, -1.15, -0.849, -1.46, 0.185, -0.21, 0.899, -0.25, 0.933, -0.548,
                         -0.633, 0.495, 0.7, 0.341, -0.536, -1.07, 0.43, -0.342, -0.162, -0.393, -1.36]

# FROM GARRETT'S THESIS
source_list_garrett = ['J15530132-2114135', 'J15582981-2310077', 'J15583692-2257153', 'J16001844-2230114', 'J16014086-2258103',
               'J16020757-2257467', 'J16024152-2138245', 'J16035767-2031055', 'J16042165-2130284', 'J16054540-2023088',
               'J16062196-1928445', 'J16072625-2432079', 'J16075796-2040087', 'J16082324-1930009', 'J16090075-1908526',
               'J16111330-2019029', 'J16113134-1838259', 'J16123916-1859284', 'J16135434-2320342', 'J16141107-2305362',
               'J16142029-1906481', 'J16153456-2242421', 'J16154416-1921171', 'J16181904-2028479']

    # the distance is in parsec
distance_list_garrett = [146.35, 147.5, 166.08, 137.67, 108.83, 140.28, 141.8, 143.57, 150.11, 145.1, 145, 142.79, 198.38,
                            138.02, 137.61, 155.3, 127.92, 138.15, 145, 145, 149.96, 139.71, 131.77, 137.92]

    # the masses are M/M_sun
masses_list_garrett = [0.186, 0.294, 1.418, 0.151, 0.188, 0.359, 0.151, 0.984, 1.195, 0.426, 0.702, 0.237, 0.676, 0.563, 0.702,
                       0.294, 0.984, 0.633, 0.151, 1.195, 0.702, 0.702, 0.984, 0.151]

flux_list_2_87mm = [0.603, 0.58, 5.18, 0.36, 0.28, 0.49, 1.08, 0.41, 5.94, 1, 0.62, 1.08, 2.37, 3.1, 3.19, 0.69, 54.1,
                    0.4, 1.25, 0.71, 3.19, 1.26, 2.04, 0.52]

flux_list_0_88mm_garrett = [5.78, 5.86, 174.92, 3.89, 3.45, 5.26, 10.25, 4.30, 218.76, 7.64, 4.08, 13.12, 23.49, 43.19, 47.28,
                            4.88, 903.26, 6.01, 7.53, 4.77, 40.69, 11.75, 26.57, 4.62]

error_mass_garrett = [0.0005, 0.0008, 0.0002, 0.0005, 0.0005, 0.0009, 0.0005, 0.0005, 0.0004, 0.0009, 0.0007, 0.0008, 0.001,
                      0.0009, 0.0007, 0.0008, 0.0005, 0.0008, 0.0005, 0.0004, 0.0007, 0.0007, 0.0005, 0.0005]


actual_mass_2 = []
lower_error = []
upper_error = []

print(len(source_list_garrett))
print(len(masses_list_garrett))

for i in masses_list_barenfeld:
    actual_mass_2.append(10 ** i)

i_list = []
for i in range(len(actual_mass_2)):
    for x in range(len(masses_list_garrett)):
        if source_list_barenfeld[i] == source_list_garrett[x]:
            i_list.append(i)

            print(x, i)

i = len(actual_mass_2)
i_list.sort(reverse=True)
for i in i_list:
        actual_mass_2.pop(i)
        flux_list_0_88mm_barenfeld.pop(i)
        lower_error_mass_barenfeld.pop(i)
        upper_error_mass_barenfeld.pop(i)


for i in upper_error_mass_barenfeld:
    upper_error.append(10 ** i)

for i in lower_error_mass_barenfeld:
    lower_error.append(10 ** (-i))


x = np.linspace(0.1, 0.10000000001)
y = np.linspace(0.1, 0.10000000001)


asymmetric_error = [error_mass_garrett, error_mass_garrett]
plt.errorbar(masses_list_garrett, flux_list_0_88mm_garrett, c='red', xerr=asymmetric_error, fmt='o', ls='none')

asymmetric_error = [lower_error, upper_error]
plt.scatter(actual_mass_2, flux_list_0_88mm_barenfeld, c='gray')
plt.errorbar(actual_mass_2, flux_list_0_88mm_barenfeld, xerr=asymmetric_error, yerr= None, ls='none')

plt.plot(x, y)
plt.xlabel(r'$M_{\star}(M_{\odot})$'), plt.ylabel('$F_{0.88mm}(mJy)$')
plt.yscale('log'), plt.xscale('log')
plt.savefig('Fig 1')
plt.show()
